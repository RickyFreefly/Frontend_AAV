{% extends "base.html" %}

{% block title %}Egresos{% endblock %}

{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/cierredia.css') }}">
<div class="dashboard-container">
  <h1 class="page-title">📑 Gestión de Egresos</h1>
  <a href="{{ url_for('dashboard.index') }}" class="btn-volver">⬅️ Volver</a>

  <!-- Tarjeta formulario -->
  <div class="card-form">
    <h3 class="form-title">➕ Crear Egreso</h3>
    <form method="post" action="{{ url_for('egresos.crear_egreso') }}" class="egreso-form">
      <div class="form-grid-2">
        <div class="form-group">
          <label>📅 Fecha</label>
          <input type="date" name="fecha_mostrar" value="{{ fecha_actual }}" readonly>
        </div>

        <div class="form-group">
          <label>💡 Concepto</label>
          <input type="text" name="concepto" placeholder="Ej: Compra insumos" required>
        </div>

        <div class="form-group">
          <label>🏢 Proveedor</label>
          <input type="text" name="proveedor" placeholder="Ej: Papelería Central" required>
        </div>

        <div class="form-group">
          <label>💲 Valor</label>
          <input type="number" step="0.01" name="valor" placeholder="0.00" required>
        </div>

        <div class="form-group">
          <label>💳 Método de Pago</label>
          <select name="metodopago" required>
            <option value="Efectivo">Efectivo</option>
            <option value="Transferencia">Transferencia</option>
            <option value="Tarjeta">Tarjeta</option>
          </select>
        </div>

        <div class="form-group full-width">
          <label>📝 Observación</label>
          <input type="text" name="observacion" placeholder="Escriba una nota opcional">
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-primary">💾 Agregar Egreso</button>
      </div>
    </form>
  </div>

  <!-- Listado de egresos -->
  <div class="table-responsive">
    <table class="egresos-table styled-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Fecha</th>
          <th>Concepto</th>
          <th>Proveedor</th>
          <th>Valor</th>
          <th>Método Pago</th>
          <th>Usuario</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        {% for e in egresos %}
        <tr>
          <td>{{ e.idegreso }}</td>
          <td>{{ e.fecha[:10] }}</td>
          <td>
            <a href="{{ url_for('egresos.detalle_egreso', id=e.idegreso) }}" class="btn-link">
              {{ e.concepto }}
            </a>
          </td>
          <td>{{ e.proveedor }}</td>
          <td>${{ "%.2f"|format(e.valor|float) }}</td>
          <td>{{ e.metodopago }}</td>
          <td>{{ e.usuario or '—' }}</td>
          <td><span class="badge pagado">PAGADO</span></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
